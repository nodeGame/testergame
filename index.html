<!doctype html>
<title>Testergame</title>

<!-- Loading  nodeGame libraries and CSS -->
<script src="http://localhost:8080/socket.io/socket.io.js"></script> 
<script src="http://localhost:8080/javascripts/nodegame-full.js" charset="utf-8"></script>
<link rel="stylesheet" href="./node_modules/mocha/mocha.css" />
<link rel='stylesheet' href='http://localhost:8080/stylesheets/player.css'></link>
<!-- end -->

<!-- Loading the Ultimatum game -->
<script src="./Ultimatum.js" charset="utf-8"></script>
<!-- end -->

<body>

<!-- Initializing mocha-phantomjs -->
<div id="mocha"></div>
<script src="./node_modules/mocha/mocha.js"></script>
<script src="./node_modules/chai/chai.js"></script>
<script>
    mocha.ui('bdd');
    mocha.reporter('html');
    var expect = chai.expect;
</script>
<script src="./test/unittest.js"></script>
<!-- end -->

<div id="root"></div>
<script>
  window.onload = function () {

		// Configure the Client
			
		var conf = {
			// HOST needs to be specified only 
			// if this file is located in another server
			// host: http://myserver.com,	  
			verbosity: 100,
      io: {        
           reconnect: false
      },
      window: {
    	  promptOnleave: false
      },
			env: {
        auto: false,
        debug: false
      },
      player: {
			  name: "P_" + Math.floor(Math.random()*100)
      },
      events: {
    	  dumpEvents: false
      }
		};
		
		node.setup('nodegame', conf);
		
		node.setup('socket', {
        type: 'SocketIo'
		});
		
		//node.socket.setSocketType('SocketIo');
		  
        W.preCache(['html/pregame.html',
                    'html/instructions.html',
                    'html/bidder.html',
                    'html/resp.html',
                    'html/solo.html',
                    'html/postgame.html',
                    'html/ended.html'],
                    function () {
                        node.connect('/testergame');
                        node.play(new Ultimatum());

                        // Run tests:
                        doUnitTest();
                        if (window.mochaPhantomJS) { mochaPhantomJS.run(); }
                        else { mocha.run(); }
                    });
	}
</script>

</body>
